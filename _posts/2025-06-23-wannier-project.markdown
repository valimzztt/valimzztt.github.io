---
layout: post
date:   2025-12-23 20:44:51 +0100
title:  Calculating Crystal Field Splitting via Wannier Functions
categories: [projects]
author: Valentina Mazzotti
---
# Calculating Crystal Field Splitting via Wannier Functions

One of the foundational concepts in the theory of transition metal (TM)
oxides is the interaction of a TM ion with the electrostatic potential
created by its surrounding ions, known as the crystal field
{% cite griffith1961theory %}. Crystal field theory predicts that in transition
metal oxides, particularly in perovskites, the $$d$$-orbitals of the TM
cation split into two energy levels: the lower-energy $$t_{2g}$$ orbitals
and the higher-energy $$e_g$$ orbitals, separated by the crystal field
splitting energy. This splitting results from the interaction between
the $$d$$-electrons of the TM ion and the electrostatic field generated by
surrounding anions, influencing phenomena such as magnetism, Mott
insulating behavior, and Jahn-Teller distortions {% cite CFT_Theory %}. For the
past 30 years, density functional theory (DFT) has been the dominant
method for the quantum mechanical simulation of periodic systems, as it
provides a computationally efficient approach for studying the
electronic structure of atoms, molecules, and solids {% cite DFT %}. While the
electronic ground state of a periodic system is often described using
extended Bloch orbitals, an alternative representation in terms of
localized "Wannier functions" was introduced by Gregory Wannier in
1937 {% cite Marzari2012 %}. By combining DFT with maximally localized Wannier
functions (MLWFs) {% cite Marzari1997 %}, we can calculate the on-site energies
of $$d$$-orbitals and determine the crystal field splitting in transition
metal oxides {% cite Scaramucci2014 %}. In this study, we apply this approach to
two perovskites, and , reconstructing the electronic structure to
extract crystal field splitting values. In this work, we investigate the
crystal field splitting in the perovskites and by reconstructing their
electronic structures using density functional theory (DFT) combined
with maximally localized Wannier functions (MLWFs). By constructing sets
of Wannier functions corresponding to different energy windows, we
successively isolate the effects of hybridization with various ligand
states and identify the hybridization component in the derived crystal
field splitting. The paper is organized as follows: I will present the
theory of CFT and the construction of MLWF in the Theory section, then I
will briefly present the workflow that I used to construct a simplified
yet accurate description of the electronic structure, allowing me to
derive the crystal field splitting. We then present results for two
perovskite oxide, where we evaluate the effect of

## Crystal field splitting in octahedral complexes

Crystal field theory (CFT) describes the breaking of degeneracies of
electron orbital states, usually $$d$$ or $$f$$ orbitals, due to a static
electric field produced by a surrounding charge distribution (the anion
neighbors) {% cite bethe1929termaufspaltung %}. As a ligand approaches the metal
ion, the electrons from the ligand will be closer to some of the
$$d$$-orbitals and farther away from others, causing a loss of degeneracy,
and giving rise to the characteristic energy splitting of the
$$d$$-orbitals. This split is influenced by factors such as the metal's
oxidation state, ligand geometry and arrangement, the coordination
number, and the type of ligands {% cite penney1932influence %}, which means that
each system has its own crystal field splitting, and precise derivations
of its value can only be found either by experiment or by *ab-initio*
calculations on the system itself. The most common type of complex
investigated in CFT is octahedral, in which six ligands form the
vertices of an octahedron around the metal ion. Taking as an example, we
can illustrate the crystal field splitting of the $$d$$-orbitals in an
octahedral complex. In SrVO$$_3$$, the vanadium (V) atom, shown in light
blue in Fig. [1](#fig:figs_wannnier/SrVO3_structure){reference-type="ref"
reference="fig:SrVO3_structure"}, is positioned at the center of an
octahedron formed by six surrounding oxygen (O) atoms (red). This
octahedral arrangement of ligands (O$$^{2-}$$ anions) creates a crystal
field that interacts with the $$d$$-orbitals of the central V$$^{4+}$$ ion,
which has a $$3d^1$$ electron configuration. In octahedral symmetry, the
$$d$$-orbitals split into two sets with an energy difference,
$$\Delta_{\text{oct}}$$ {% cite InfluenceOfCrystallineFields %}; {% cite CFT_Theory %}. In
this environment, the $$d_{xy}$$, $$d_{xz}$$, and $$d_{yz}$$ orbitals
experience less repulsion from the ligands and are therefore lower in
energy, collectively referred to as the $$t_{2g}$$ set. In contrast, the
$$d_{z^2}$$ and $$d_{x^2-y^2}$$ orbitals, which are oriented directly
towards the ligands, experience higher repulsion and form the
higher-energy $$e_g$$ set.

$$VO3$$ serves as a prototypical example of a transition metal oxide, where
the $$3d$$ orbitals of V$$^{4+}$$ ions experience crystal field splitting
due to the surrounding oxygen ligands, resulting in a characteristic
separation between the $$t_{2g}$$ and $$e_g$$ orbitals {% cite Scaramucci2014 %}.
<div style="float: right; margin-left: 20px; margin-bottom: 10px; max-width: 40%;">
  <img src="/assets/images/figs_wannier/SrVO3_poscar.PNG" alt="SrVO3 Structure" style="width: 100%; border-radius: 6px;">
  <p style="text-align: center; font-size: 0.85rem; color: #666; margin-top: 5px;">
    Fig 1. The crystal structure of $SrVO_3$
  </p>
</div>

## Construction of Maximally Localized Wannier Functions

The electronic states within a solid are typically represented by Bloch
states, which correspond to the eigenfunctions of the single-particle
Hamiltonian for electrons in the periodic effective crystal potential. 

In order to understand the further steps I will introduce the tight-binding (TB) model, which is a foundational method in solid-state physics for calculating the electronic band structure of crystalline solids. The tight-binding approximation begins with the assumption that near each lattice point, the full periodic crystal Hamiltonian $$H$$ can be approximated by the atomic Hamiltonian $$H_{\text{at}}$$. We use atomic orbitals $$\varphi_n(\mathbf{r})$$, eigenfunctions of $$H_{\text{at}}$$, to construct the electronic states of the crystal.

$$
H_{\text{at}} \varphi_n = E_n \varphi_n
$$

In the crystal, the atomic wavefunctions $$\varphi_n(\mathbf{r})$$ overlap with those of neighboring atoms. To account for the crystal potential, we express the Hamiltonian as:

$$
H = H_{\text{at}} + \Delta U(\mathbf{r})
$$

The solution to the Schr√∂dinger equation is approximated as a linear combination of atomic orbitals (LCAO):

$$
\psi_m(\mathbf{r}) = \sum_{\mathbf{R}_n} b_m(\mathbf{R}_n)\ \varphi_m(\mathbf{r} - \mathbf{R}_n)
$$

The eigenstates $$\psi$$ of the crystal Hamiltonian can be written using Bloch's theorem:

$$
\psi_{n\mathbf{k}}(\mathbf{r}) = e^{i\mathbf{k} \cdot \mathbf{r}} u_{n\mathbf{k}}(\mathbf{r})
$$

Here, $$u_{n\mathbf{k}}(\mathbf{r})$$ is periodic with the Bravais lattice. The wave vector $$\mathbf{k}$$ is confined to the first Brillouin zone, and each state is indexed by a band $$n$$. The Hamiltonian becomes diagonal in this Bloch basis:

$$\hat{H} = \sum_{n\mathbf{k}} \varepsilon_{n\mathbf{k}} a^{\dagger}_{n\mathbf{k}} a_{n\mathbf{k}}.$$

Here, $$a^{\dagger}_{n\mathbf{k}}$$ is the creation operator for an
electron in the Bloch state $$|\psi_{n\mathbf{k}}\rangle$$, and
$$\varepsilon_{n\mathbf{k}}$$ is the corresponding single-particle energy.

This formalism describes electrons as **delocalized states**, extended across the crystal. Wannier functions, on the other hand, can be a powerful tool in the study
of the electronic and dielectric properties of materials: acting as the
solid-state counterpart to "localized molecular orbitals" {% cite Boys1966 %},
they provide an insightful picture of the chemical bonding, which is
instead missing from the Bloch picture of extended orbitals. By
transforming the occupied electronic manifold into a set of maximally
localized Wannier functions (MLWFs), one gains deeper insights into
chemical coordination and bonding characteristics. The most general
operation that transforms the Bloch orbitals into a set of Wannier
functions $$|w_{\alpha \mathbf{R}}\rangle$$ is given by:

$$|w_{\alpha \mathbf{R}} \rangle = \frac{V}{(2\pi)^3} \int_{\text{BZ}} d^3k \, e^{-i \mathbf{k} \cdot \mathbf{R}} \sum_{n} U^{(\mathbf{k})}_{\alpha n} |\psi_{n\mathbf{k}} \rangle.$$

where $$U^{(\mathbf{k})}$$ is a unitary matrix that
mixes the Bloch functions at the same $$\mathbf{k}$$-point. The Wannier
orbitals are characterized by a unit cell index $$\mathbf{R}$$ and an
additional index $$\alpha$$ that distinguishes different Wannier orbitals
within the same unit cell. Since different choices for the
$$\mathbf{k}$$-dependent unitary matrix $$U^{(\mathbf{k})}$$ lead to
different Wannier orbitals, these are therefore not uniquely defined by
Equation [\[eq:equation2\]](#eq:equation2){reference-type="ref"
reference="eq:equation2"}. To obtain a unique set of Wannier functions,
it is possible to impose a "gauge" condition that minimizes the total
quadratic spread of the Wannier orbitals. This approach yields what are known as "maximally localized Wannier functions" (MLWFs) {% cite Marzari1997 %}.
$$
\Omega = \sum_n \left[ \langle w_n | r^2 | w_n \rangle - \langle w_n | \mathbf{r} | w_n \rangle^2 \right]
$$


# RESULTS & DISCUSSION

The process of extracting the crystal field splittings begins with the
ionic relaxation of the conventional cell of or . This initial step
optimizes the atomic positions within the unit cell to minimize the
total energy, resulting in the ground-state geometry. Once the structure
is relaxed, a self-consistent field (SCF) calculation is performed to
obtain the ground-state Kohn-Sham energies and wavefunctions. These
results form the basis for the subsequent band structure and density of
states (DOS) calculations.

<div style="float: right; margin-left: 20px; margin-bottom: 10px; max-width: 60%;">
  <img src="/assets/images/figs_wannier/Bandstructure_SrVO3.png" alt="SrVO3 Structure" style="width: 100%; border-radius: 6px;">
  <p style="text-align: center; font-size: 0.85rem; color: #666; margin-top: 5px;">
    Fig 2. Bandstructure of $SrVO_3$
  </p>
</div>

The band structure is then calculated by tracing the Kohn-Sham
eigenvalues along a predefined path connecting high-symmetry points in
the Brillouin zone. The band structure will then serve as a guide for
selecting the orbitals and the energy range that will be used to build
the TB model. To identify the character of each band, we project the
obtained onto specific orbitals, such as $$s$$, $$p$$, and $$d$$ orbitals.
Based on these projections, initial guesses for the Wannier functions
are selected to serve as the localized basis functions in the TB model.
When building our model, we need to select by default the $$d$$ orbitals of
the $$3d$$ transition metal ion octahedrally coordinated with oxygen, but
there is the questions in which other orbital of which atom are
necessary to add to the tight binding model to truthfully reconstruct
the bandstructure. Moreover, due to the non-uniqueness of Wannier
functions {% cite CFTWannier %}, after having selected the appropriate parameters
and initial projections, we use the VASP2WANNIER90 interface
{% cite Franchini2012 %} to project the DFT Bloch states onto maximally
localized Wannier functions (MLWFs) centered on the $$d$$-orbitals of the
$$V^{4+}$$ and $$Ti^{3+}$$ ions. The Wannier90 code {% cite Mostofi2014 %}
is then employed to iteratively minimize the spread functional,
resulting in MLWFs centered on the $$d$$-bands of $$V^{4+}$$ (or
$$Ti^{3+}$$). Finally, the crystal field splitting
$$\Delta_{\text{o}}$$ is calculated from the on-site energy difference
between the $$e_g$$ orbitals ($$d_{x^2-y^2}$$ and $$d_{z^2}$$) and the
$$t_{2g}$$ orbitals ($$d_{xy}$$, $$d_{yz}$$, and $$d_{zx}$$) of the $$3d$$
transition metal, as follows:

$$
\Delta_{\text{o}} = \frac{\epsilon_{d_{x^2 - y^2}} + \epsilon_{d_{z^2}}}{2}
- \frac{\epsilon_{d_{xy}} + \epsilon_{d_{yz}} + \epsilon_{d_{zx}}}{3}
$$

where each $$\epsilon$$ represents the on-site energy obtained from the
Wannier-based TB Hamiltonian.

We apply the workflow to derive the crystal field splitting in VO2, a cubic
perovskite where V is in the $$4+$$oxidation state with a$$3d^1$$
configuration. This single $$d$$-electron experiences octahedral crystal
field splitting into lower-energy $$t_{2g}$$and higher-energy$$e_g$$
orbitals due to interactions with the surrounding oxygen ligands. The
band structure of (Fig. 2) reveals distinct groups of bands
corresponding to V-$$d$$($$t_{2g}$$ and$$e_g$$) and O-$$p$$ orbital
characters, enabling an initial estimate of the crystal field splitting
at approximately $$2 \, \text{eV}$$.

To quantify this numerically, we first construct MLWFs for only the
$$d$$-orbital bands, confined to $$4 \, \text{eV}$$to$$11 \, \text{eV}$$
relative to the Fermi energy. This model captures the full crystal field
splitting of the V-$$d$$states in VO2. Next, we include the$$p$$-orbitals of
oxygen, expanding the energy range to $$-2 \, \text{eV}$$ to
$$11 \, \text{eV}$$. By constructing a tight-binding model that includes
both V-$$d$$ and O-$$p$$ orbitals, we observe that the Wannier functions
(WFs) centered on vanadium become significantly less extended. 

<div class="table-container">
  <table>
    <caption>Table 1: Crystal field splitting values for different bands included in the Wannier construction, with associated errors.</caption>
    <thead>
      <tr>
        <th>Bands used in WFs</th>
        <th>Symbol</th>
        <th>Value [eV]</th>
        <th>Error [eV]</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>only V-$d$</td>
        <td>$$\epsilon_{e_g}^{(d)} - \epsilon_{t_{2g}}^{(d)}$$</td>
        <td>2.8099</td>
        <td>0.0003</td>
      </tr>
      <tr>
        <td>V-$d$ and O-$p$</td>
        <td>$$\epsilon_{e_g}^{(dp)} - \epsilon_{t_{2g}}^{(dp)}$$</td>
        <td>1.787616</td>
        <td>0.001</td>
      </tr>
    </tbody>
  </table>
</div>

The bonding and anti-bonding nature of the V-$$t_{2g}$$ and O-$$2p$$ bands explains the
localization trends. WFs from only anti-bonding bands are more extended
due to retained O-$$p$$ character, as indicated by larger spreads
(Table 2). However, if we expand the
energy window to include both bonding and anti-bonding bands (and
therefore increase the energy range and the number of WFs used in the
tight binding model), the resulting WFs resemble atomic-like V and O
functions more closely, and are therefore more localized. Although there
remains a small V-$$d_{xy}$$ component on the O sites to maintain
orthogonality among WFs, this component is considerably reduced compared
to when only the anti-bonding band is used. For both sets, we record the
on-site energies of the V-centered $$d$$-like Wannier functions. The crystal field splitting is
then obtained as the difference of the mean V-$$e_g$$-like and
V-$$t_{2g}$$-like Wannier function. When comparing the splitting of the
on-site energies between the V-$$e_g$$-like and V-$$t_{2g}$$-like Wannier
functions for the two sets (see Table 1), it is evident that this splitting
is reduced by approximately $$1 \, \text{eV}$$ in the second set compared to the
first. This reduction can be attributed to hybridization between the
central V-$$d$$ orbitals and the $$p$$-orbitals of the surrounding oxygen
ligands. 

<div style="float: right; margin-left: 20px; margin-bottom: 10px; max-width: 60%;">
  <img src="/assets/images/figs_wannier/comparison_SrVO3.png" alt="SrVO3 Structure" style="width: 100%; border-radius: 6px;">
  <p style="text-align: center; font-size: 0.85rem; color: #666; margin-top: 5px;">
    Figure 3: Comparison of DFT computed bandstructure and reconstructed band structure of $SrVO3$ using two different sets of Wannier functions (WFs). The blue lines represent the band structure reconstructed with 5 WFs centered on the V $d$-orbitals, while the red lines represent the reconstruction with 14 WFs, including both V $d$-orbitals and O $p$-orbitals. Although the inclusion of O $p$-orbitals in the Wannier construction (14 WFs) leads to a more accurate representation of the full electronic structure, the quality of the Wannier-interpolated band structure is very similar. 
  </p>
</div>
 In the first set, as previously mentioned, hybridization
between the central V-$$d$$orbitals and the$$p$$-orbitals of the
surrounding oxygen ligands enforces significant O-$$p$$ character on the
V-centered Wannier functions, which contributes to and increases the
crystal field splitting value.

Finally, the accuracy of our TB model for  $$SrVO_3$$ is validated by verifying that the atomic positions align with the final Wannier centers. Moreover, the WFs interpolated bandstructure is calculated using both sets of Wannier functions. We note that both sets of Wannier functions perform equally well in reconstructing the band structure within the energy range of 2 to 5 eV, where the $$d$$-orbitals of $$V$$ dominate the electronic states, as seen from Figure 3.
We note that in the first set of Wannier functions, where MLWFs were constructed solely for the $$d$$-orbital bands, the interpolated band structure naturally reproduces only the $$d$$-band contributions. 


{% bibliography --cited %}

<style>
  .table-container {
    margin: 2rem auto;
    max-width: 100%;
    overflow-x: auto; /* Handles scroll on mobile */
  }

  table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 1rem;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
  }

  caption {
    caption-side: top;
    text-align: center;
    font-style: italic;
    color: #666;
    margin-bottom: 10px;
    font-size: 0.95rem;
  }

  th, td {
    border: 1px solid #ddd; /* Adds the grid lines */
    padding: 12px;
    text-align: center; /* Centers text in cells */
    vertical-align: middle;
  }

  th {
    background-color: #f8f9fa;
    font-weight: 600;
    color: #333;
  }

  /* Optional: Aligns the first column to the left if preferred */
  td:first-child, th:first-child {
    text-align: left;
  }
</style>